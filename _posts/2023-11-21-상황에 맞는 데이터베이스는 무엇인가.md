---
title: 상황에 맞는 데이터베이스는 무엇인가
author: heehong
date: 2023-11-21 19:00:00 +0800
categories: [데이터베이스]
tags: [데이터베이스, RDB, NOSQL]
published: true
---

# 상황에 맞는 데이터베이스는 무엇인가

##### RDB 와 NoSql 

- 전제상황

> MSA 구조로 개발이 되고 있는 상황이다.
>
> 자주 변경되지 않고 확장 가능성이 있는 메타 데이터는 NoSql 로
>
> 정합성, 무결성이 중요한 주문, 결제 데이터 정보는  RDB 로 개발되어 있는 상황이다.
>
> 정산시 사용될 데이터는 어떤 DB 를 사용해야 할까?

- 분석

1. 시스템에 따라서 어떤 DB가 사용되어야 할까?
2. 데이터베이스별 분석 - 장점, 단점, 고려사항
3. 상황에 따른 데이터베이스 비교
4. 데이터 처리시 RDB와 NoSql 은 성능 차이가 날까?

----

#### DB 점유율 

https://db-engines.com/en/ranking

![데이터베이스현황](/assets/img/post/2023-11-21-상황에%20맞는%20데이터베이스는%20무엇인가/데이터베이스%20현황.png)

----

## NoSql

#### 특징

- 대표적으로 MongoDB

- 스키마 선언 없이 사용하기에 필드의 추가 및 삭제가 용이하다.

- 스케일 업, 스케일 아웃으로 서버 확장이 용이하다.  

- **대용량 데이터를 처리하는 성능이 뛰어나다.** 

- 데이터가 중복될 수 있어서 Update 가 자주 일어나는 경우 성능이 저하될 수 있다. -> 중복 된 정보를 모두Update 해야 하기 떄문에

#### 도입을 고려할 수 있는 경우

- 정확한 데이터 구조를 알 수 없거나 변경이나 확장이 될 수 있는 경우
- 데이터가 자주 변경되지 않고, 읽기 처리를 자주해야 하는 상황 
- 대용량 데이터 처리가 빠르게 이루어져야 할 경우

----

## RDB

> 관계형 데이터베이스로 관계형 모델을 기반으로 한 데이터베이스이다.

#### 특징

- 대표적으로 Oracle, Mysql, PostgreSql

- 데이터의 무결성과 정합성이 보장된다.

  > 데이터 무결성: 데이터 값이 정확한 상태
  >
  > 데이터 정합성: 어떤 데이터들의 값이 서로 일치함

- 테이블 설계를 바탕으로 정형화된 구조를 필요로 한다. 엔티티 간 관계가 정의된다. 정규화를 필요로 한다.

  > 정규화란 테이블 간에 중복된 데이터를 허용하지 않도록 설계하는 것을 말한다. 무결성을 유지하고 중복을 제거하여 불필요한 용량을 줄일 수 있다. 실제 개발시 필요에 따라 부분정규화를 하기도 한다.

- 스키마 변경, 테이블 필드 변경 및 수정시 추가적인 작업이 필요하다.

  - 정형화 되어 있기 때문에 테이블 필드 이름이나 타입을 변경시 해당 필드와 관계를 가지고 있는 테이블의 필드와의 관계도 재정의가 필요하다. 서로 의존성을 가지고 있기 때문. 운영환경에서는 거의 사실상 불가능에 가깝다. 

- 스케일 업은 가능하지만 스케일 아웃은 어렵다.

  > 스케일업(Scale-up)은 기존의 서버를 보다 높은 사양으로 업그레이드 하는 것을 말한다. 수직 스케일링이라고도 불린다. 성능 확장에 한계가 있고 비용이 많이 필요로 한다.
  >
  > 스케일 아웃(Scale-out) 서버를 추가로 확장하는 것을 말한다. 그래서 수평 스케일링이라고도 한다.

  - RDB가 수직확장이 더 용이한 이유는 데이터가 여러 테이블에 의존해 있기 때문이다. 

- 테이블 관계가 생기고 조인을 사용함에 따라서 쿼리가 복잡해질 수 있다.



----

### 고려할 수 있는 사항

1. **주문, 결제 정보와 동일하게 정산시스템을 RDB로 구현한다.**

   - 주문, 결제 정보는 유일성과 정합성이 중요시되는 데이터이기 때문에 RDB 로 구현이 되어 있다. 따라서 정산 시스템도 개발과 관리에 용이하도록 동일한 RDB 를 사용한다. 
   - RDB 의 집계에 익숙하다. 
   - 많은 양의 데이터를 쌓게되면 부하가 걱정된다.
   - 테이블 관계가 복잡해지면 쿼리가 복잡해질수도 있다.

2. **정산시스템은 많은 양의 데이터를 정산해야 하기 때문에 대용량이나 속도로서의 이점을 가지고 있는 NoSql 을 이용한다.** 

   - 집계 쿼리에 익숙하지 않다. -> 간단한 쿼리만 사용하게 될 듯하다.

   - RDB 를 사용하고 있는 주문, 결제 정보를 집계 쿼리를 통해 NoSql 의 정산 데이터로 처리 및 저장하여 조회시 NoSql을 이용하여 정산 정보를 보여준다. 
   - 테이블간의 관계가 없어서 데이터를 저장하기에 더 용이하다. 
   - 생각해보니 복잡한 집계 쿼리는 어차피 RDB를 통해서 처리해야 한다.
   - 데이터를 쌓아서 그대로 보여주거나 간단한 집계라면 NoSql 에 이점이 더 많을 것으로  고려된다.

----

### RDB 와 NoSql 성능 비교 

NoSql에 대해 찾아 보면 **대용량처리시 성능이 좋다** 라는 특징을 찾아볼 수 있다.

실제로 그럴까? 

> 대용량 데이터란 어느 정도 크기의 데이터를 대용량 데이터라고 할까? 
>
> 크다 와 작다를 이야기 할 때 절대적인 기준이 있기는 쉽지 않다.
>
> 1억건의 데이터? 1만건의 데이터? 
>
> 데이터를 다뤄보지 않은 사람 입장에서는 3만 건의 데이터도 굉장히 크게 느낄 수 있다. 그렇다고 작다고 이야기하기도 그렇다.
>
> 그때 그때 마다 다르다. 
>
> 데이터가 얼마나 커야 할까? 라는 고민을 하는 것보다는 어느 정도의 데이터를 가지고 있으면 분석해 볼 만한 가치가 있을까? 를 고민하는것이 더 현명하다.

https://brunch.co.kr/@8d1b089f514b4d5/21 를 참고하였습니다.

사실 나도 최대로 많은 데이터를 다뤄본게.. 500만건 정도 인것 같다.



RDB 와 NoSql 의 성능 비교를 위해 검색 중에 내가 원하는 것과 동일한 대학교 석사 논문을 발견했다.

해당 논문은 MySql 과 MongoDB의 성능을 비교, 분석하고 있어 참고하였다.

https://scienceon.kisti.re.kr/srch/selectPORSrchArticle.do?cn=DIKO0014144757&dbt=DIKO#



그래프를 활용하고 싶었으나.. 가져와도 되나 싶어서 안가져왔다.

성능 측정을 위해 1000만건의 데이터를 임의로 생성하여 쓰기, 읽기 속도를 비교하여 분석하였다.

결과는 전체 읽기 성능 결과 압도적으로 MongoDB가 높은 것으로 확인되었다.